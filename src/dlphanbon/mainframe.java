/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package dlphanbon;

import java.awt.event.KeyEvent;
import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author Dell
 */
public class mainframe extends javax.swing.JFrame {

    /**
     * Creates new form mainframe
     */
    public mainframe() {
        initComponents();
        setLocationRelativeTo(this);
        setExtendedState(MAXIMIZED_BOTH);
    }
    int click=0;
    int themKHmoi = 0;
    int suathongtin = 0;
    int themHHmoi = 0;
    int suathongtinHH = 0;

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jFrame1 = new javax.swing.JFrame();
        jFrame2 = new javax.swing.JFrame();
        jFrame3 = new javax.swing.JFrame();
        jDialog1 = new javax.swing.JDialog();
        jFrame4 = new javax.swing.JFrame();
        jFrame5 = new javax.swing.JFrame();
        jFrame6 = new javax.swing.JFrame();
        jFrame7 = new javax.swing.JFrame();
        jLabel25 = new javax.swing.JLabel();
        changePWD = new javax.swing.JButton();
        quanlydonhang = new javax.swing.JTabbedPane();
        jPanel3 = new javax.swing.JPanel();
        jLabel26 = new javax.swing.JLabel();
        jLabel27 = new javax.swing.JLabel();
        jGTChucNang = new javax.swing.JPanel();
        jLabel30 = new javax.swing.JLabel();
        jLabel31 = new javax.swing.JLabel();
        jlogin = new javax.swing.JPanel();
        label_matkhau = new javax.swing.JLabel();
        nhap_matkhau = new javax.swing.JPasswordField();
        unblock_changePWD = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane13 = new javax.swing.JScrollPane();
        table_hanghoa = new javax.swing.JTable();
        TTHH_mahang = new javax.swing.JTextField();
        jLabel_MaKH1 = new javax.swing.JLabel();
        jLabel32 = new javax.swing.JLabel();
        TTHH_giaban = new javax.swing.JTextField();
        jLabel39 = new javax.swing.JLabel();
        jLabel42 = new javax.swing.JLabel();
        jLabel44 = new javax.swing.JLabel();
        TTHH_suathongtin = new javax.swing.JButton();
        TTHH_huyluachon = new javax.swing.JButton();
        TTHH_huy = new javax.swing.JButton();
        TTHH_luu = new javax.swing.JButton();
        TTHH_themHHmoi = new javax.swing.JButton();
        TTHH_loaihang = new javax.swing.JComboBox<>();
        jLabel2 = new javax.swing.JLabel();
        jScrollPane14 = new javax.swing.JScrollPane();
        TTHH_tenhang = new javax.swing.JTextArea();
        jPanel_quanlykhohang = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        table_thongkekhohang = new javax.swing.JTable();
        jLabel8 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        jLabel11 = new javax.swing.JLabel();
        nhapkho_chonmahang = new javax.swing.JComboBox<>();
        button_nhapkho = new javax.swing.JButton();
        nhapkho_soluongnhapkho = new javax.swing.JTextField();
        jScrollPane6 = new javax.swing.JScrollPane();
        table_nhatkynhapkho = new javax.swing.JTable();
        jLabel13 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jScrollPane16 = new javax.swing.JScrollPane();
        nhapkho_tenhang = new javax.swing.JTextArea();
        jLabel50 = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        CTDH_table = new javax.swing.JTable();
        CTDH_soluong = new javax.swing.JTextField();
        CTDH_giaban = new javax.swing.JTextField();
        jLabel1 = new javax.swing.JLabel();
        Tao_DH_moi = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        Them_CTDH = new javax.swing.JButton();
        Lammoi_CTDH = new javax.swing.JButton();
        Xoa_dong_CTDH = new javax.swing.JButton();
        jScrollPane4 = new javax.swing.JScrollPane();
        table_thongtinhanghoa = new javax.swing.JTable();
        chon_mahanghoa = new javax.swing.JComboBox<>();
        jScrollPane2 = new javax.swing.JScrollPane();
        table_thongtinMaKH = new javax.swing.JTable();
        chon_makhachhang = new javax.swing.JComboBox<>();
        jLabel7 = new javax.swing.JLabel();
        text_tennguoilapHD = new javax.swing.JTextField();
        jLabel19 = new javax.swing.JLabel();
        jLabel46 = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        jLabel47 = new javax.swing.JLabel();
        jPanel5 = new javax.swing.JPanel();
        jScrollPane7 = new javax.swing.JScrollPane();
        table_thongtinkhachhang = new javax.swing.JTable();
        jLabel_MaKH = new javax.swing.JLabel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jLabel23 = new javax.swing.JLabel();
        QLKH_suathongtin = new javax.swing.JButton();
        QLKH_huyluachon = new javax.swing.JButton();
        QLKH_huy = new javax.swing.JButton();
        QLKH_luu = new javax.swing.JButton();
        QLKH_themKHmoi = new javax.swing.JButton();
        QLKH_makh = new javax.swing.JTextField();
        QLKH_tenkh = new javax.swing.JTextField();
        QLKH_sdt = new javax.swing.JTextField();
        jScrollPane11 = new javax.swing.JScrollPane();
        QLKH_diachi = new javax.swing.JTextArea();
        jLabel45 = new javax.swing.JLabel();
        jPanel4 = new javax.swing.JPanel();
        jScrollPane10 = new javax.swing.JScrollPane();
        table_thongtindonhang = new javax.swing.JTable();
        jScrollPane12 = new javax.swing.JScrollPane();
        table_danhsachdonhang = new javax.swing.JTable();
        jLabel18 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        tongtien = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        Xemtatcadonhang = new javax.swing.JButton();
        thongtindonhang_month = new javax.swing.JComboBox<>();
        jLabel34 = new javax.swing.JLabel();
        jLabel35 = new javax.swing.JLabel();
        Xemtheothangvanam = new javax.swing.JButton();
        jLabel36 = new javax.swing.JLabel();
        jLabel37 = new javax.swing.JLabel();
        thongtindonhang_madh = new javax.swing.JLabel();
        thongtindonhang_year = new javax.swing.JTextField();
        jLabel38 = new javax.swing.JLabel();
        doanhthu = new javax.swing.JLabel();
        jLabel40 = new javax.swing.JLabel();
        jLabel41 = new javax.swing.JLabel();
        SL_donhang = new javax.swing.JLabel();
        jLabel43 = new javax.swing.JLabel();
        danhsachdonhang_thoigian = new javax.swing.JLabel();
        jLabel48 = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();

        javax.swing.GroupLayout jFrame1Layout = new javax.swing.GroupLayout(jFrame1.getContentPane());
        jFrame1.getContentPane().setLayout(jFrame1Layout);
        jFrame1Layout.setHorizontalGroup(
            jFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame1Layout.setVerticalGroup(
            jFrame1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame2Layout = new javax.swing.GroupLayout(jFrame2.getContentPane());
        jFrame2.getContentPane().setLayout(jFrame2Layout);
        jFrame2Layout.setHorizontalGroup(
            jFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame2Layout.setVerticalGroup(
            jFrame2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame3Layout = new javax.swing.GroupLayout(jFrame3.getContentPane());
        jFrame3.getContentPane().setLayout(jFrame3Layout);
        jFrame3Layout.setHorizontalGroup(
            jFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame3Layout.setVerticalGroup(
            jFrame3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jDialog1Layout = new javax.swing.GroupLayout(jDialog1.getContentPane());
        jDialog1.getContentPane().setLayout(jDialog1Layout);
        jDialog1Layout.setHorizontalGroup(
            jDialog1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jDialog1Layout.setVerticalGroup(
            jDialog1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame4Layout = new javax.swing.GroupLayout(jFrame4.getContentPane());
        jFrame4.getContentPane().setLayout(jFrame4Layout);
        jFrame4Layout.setHorizontalGroup(
            jFrame4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame4Layout.setVerticalGroup(
            jFrame4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame5Layout = new javax.swing.GroupLayout(jFrame5.getContentPane());
        jFrame5.getContentPane().setLayout(jFrame5Layout);
        jFrame5Layout.setHorizontalGroup(
            jFrame5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame5Layout.setVerticalGroup(
            jFrame5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame6Layout = new javax.swing.GroupLayout(jFrame6.getContentPane());
        jFrame6.getContentPane().setLayout(jFrame6Layout);
        jFrame6Layout.setHorizontalGroup(
            jFrame6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame6Layout.setVerticalGroup(
            jFrame6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        javax.swing.GroupLayout jFrame7Layout = new javax.swing.GroupLayout(jFrame7.getContentPane());
        jFrame7.getContentPane().setLayout(jFrame7Layout);
        jFrame7Layout.setHorizontalGroup(
            jFrame7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 400, Short.MAX_VALUE)
        );
        jFrame7Layout.setVerticalGroup(
            jFrame7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 300, Short.MAX_VALUE)
        );

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Phần Mềm Quản Lý Cho Nhà Cung Cấp Phân Bón");
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jLabel25.setFont(new java.awt.Font("Tahoma", 1, 30)); // NOI18N
        jLabel25.setForeground(new java.awt.Color(0, 153, 51));
        jLabel25.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel25.setText("Nhà Sản Xuất Và Cung Cấp Phân Bón");

        changePWD.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        changePWD.setText("Đổi mật khẩu");
        changePWD.setEnabled(false);
        changePWD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                changePWDActionPerformed(evt);
            }
        });

        quanlydonhang.setTabPlacement(javax.swing.JTabbedPane.LEFT);
        quanlydonhang.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        quanlydonhang.setEnabled(false);
        quanlydonhang.setFont(new java.awt.Font("Times New Roman", 1, 18)); // NOI18N
        quanlydonhang.setPreferredSize(new java.awt.Dimension(1700, 646));
        quanlydonhang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                quanlydonhangMouseClicked(evt);
            }
        });

        jPanel3.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jLabel26.setFont(new java.awt.Font("Tahoma", 1, 28)); // NOI18N
        jLabel26.setForeground(new java.awt.Color(0, 153, 51));
        jLabel26.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel26.setText(" Phần Mềm Quản Lý Cho Nhà Cung Cấp Phân Bón ");
        jLabel26.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 153, 51), 2));

        jLabel27.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel27.setForeground(new java.awt.Color(0, 0, 204));
        jLabel27.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);

        jLabel30.setFont(new java.awt.Font("Tahoma", 1, 36)); // NOI18N
        jLabel30.setForeground(new java.awt.Color(0, 153, 0));
        jLabel30.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel30.setText("CHÀO MỪNG ĐẾN VỚI");

        jLabel31.setFont(new java.awt.Font("Tahoma", 1, 36)); // NOI18N
        jLabel31.setForeground(new java.awt.Color(0, 153, 0));
        jLabel31.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel31.setText("PHẦN MỀM QUẢN LÝ");

        jGTChucNang.setVisible(false);

        javax.swing.GroupLayout jGTChucNangLayout = new javax.swing.GroupLayout(jGTChucNang);
        jGTChucNang.setLayout(jGTChucNangLayout);
        jGTChucNangLayout.setHorizontalGroup(
            jGTChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jGTChucNangLayout.createSequentialGroup()
                .addGap(72, 72, 72)
                .addGroup(jGTChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 470, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 470, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(75, Short.MAX_VALUE))
        );
        jGTChucNangLayout.setVerticalGroup(
            jGTChucNangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jGTChucNangLayout.createSequentialGroup()
                .addGap(136, 136, 136)
                .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 68, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 64, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(233, Short.MAX_VALUE))
        );

        jlogin.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        label_matkhau.setFont(new java.awt.Font("Verdana", 0, 18)); // NOI18N
        label_matkhau.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        label_matkhau.setText("Nhập Mật Khẩu Để Mở Khóa");

        nhap_matkhau.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        nhap_matkhau.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        nhap_matkhau.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                nhap_matkhauKeyPressed(evt);
            }
        });

        unblock_changePWD.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        unblock_changePWD.setText("Mở khoá");
        unblock_changePWD.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                unblock_changePWDActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jloginLayout = new javax.swing.GroupLayout(jlogin);
        jlogin.setLayout(jloginLayout);
        jloginLayout.setHorizontalGroup(
            jloginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(label_matkhau, javax.swing.GroupLayout.PREFERRED_SIZE, 300, javax.swing.GroupLayout.PREFERRED_SIZE)
            .addGroup(jloginLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jloginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(nhap_matkhau, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(unblock_changePWD, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );
        jloginLayout.setVerticalGroup(
            jloginLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jloginLayout.createSequentialGroup()
                .addContainerGap(36, Short.MAX_VALUE)
                .addComponent(label_matkhau)
                .addGap(27, 27, 27)
                .addComponent(nhap_matkhau, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(30, 30, 30)
                .addComponent(unblock_changePWD)
                .addGap(39, 39, 39))
        );

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(21, 21, 21)
                        .addComponent(jLabel27)
                        .addGap(316, 316, 316)
                        .addComponent(jGTChucNang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(170, 170, 170)
                        .addComponent(jlogin, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(302, 302, 302)
                        .addComponent(jLabel26)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(30, 30, 30)
                .addComponent(jLabel26)
                .addGap(18, 18, 18)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(104, 104, 104)
                        .addComponent(jlogin, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jGTChucNang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(133, Short.MAX_VALUE))
        );

        quanlydonhang.addTab("<html> <body> <br> <p>TRANG CHỦ</p> <br> </body> </html>", jPanel3);

        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        table_hanghoa.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_hanghoa.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ HÀNG", "TÊN HÀNG", "LOẠI HÀNG", "ĐƠN GIÁ"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_hanghoa.setRowHeight(25);
        table_hanghoa.setRowMargin(3);
        table_hanghoa.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_hanghoaMouseClicked(evt);
            }
        });
        jScrollPane13.setViewportView(table_hanghoa);
        if (table_hanghoa.getColumnModel().getColumnCount() > 0) {
            table_hanghoa.getColumnModel().getColumn(0).setPreferredWidth(30);
            table_hanghoa.getColumnModel().getColumn(1).setPreferredWidth(280);
            table_hanghoa.getColumnModel().getColumn(2).setPreferredWidth(10);
            table_hanghoa.getColumnModel().getColumn(3).setPreferredWidth(30);
        }

        TTHH_mahang.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_mahang.setEnabled(false);

        jLabel_MaKH1.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel_MaKH1.setText("Mã Hàng");

        jLabel32.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel32.setText("THÔNG TIN HÀNG HOÁ");
        jLabel32.setToolTipText("");

        TTHH_giaban.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_giaban.setEnabled(false);

        jLabel39.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel39.setText("Tên Hàng");

        jLabel42.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel42.setText("Loại Hàng");

        jLabel44.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel44.setText("Đơn Giá");

        TTHH_suathongtin.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_suathongtin.setText("Sửa Thông Tin");
        TTHH_suathongtin.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TTHH_suathongtinActionPerformed(evt);
            }
        });

        TTHH_huyluachon.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_huyluachon.setText("Huỷ lựa chọn");
        TTHH_huyluachon.setToolTipText("");
        TTHH_huyluachon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TTHH_huyluachonActionPerformed(evt);
            }
        });

        TTHH_huy.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_huy.setText("Xóa");
        TTHH_huy.setEnabled(false);
        TTHH_huy.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TTHH_xoaActionPerformed(evt);
            }
        });

        TTHH_luu.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_luu.setText("Lưu");
        TTHH_luu.setEnabled(false);
        TTHH_luu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TTHH_luuActionPerformed(evt);
            }
        });

        TTHH_themHHmoi.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_themHHmoi.setText("Thêm Hàng Hóa");
        TTHH_themHHmoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                TTHH_themHHmoiActionPerformed(evt);
            }
        });

        TTHH_loaihang.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_loaihang.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Bao", "Chai" }));
        TTHH_loaihang.setEnabled(false);

        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel2.setText("DANH SÁCH HÀNG HOÁ");

        TTHH_tenhang.setColumns(20);
        TTHH_tenhang.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        TTHH_tenhang.setLineWrap(true);
        TTHH_tenhang.setRows(3);
        TTHH_tenhang.setWrapStyleWord(true);
        TTHH_tenhang.setEnabled(false);
        jScrollPane14.setViewportView(TTHH_tenhang);

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap(106, Short.MAX_VALUE)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(63, 63, 63)
                                .addComponent(jLabel32))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(jLabel44)
                                .addGap(45, 45, 45)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addGroup(jPanel1Layout.createSequentialGroup()
                                            .addComponent(TTHH_luu)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                            .addComponent(TTHH_huy))
                                        .addComponent(TTHH_giaban, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 134, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addComponent(TTHH_loaihang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(TTHH_mahang, javax.swing.GroupLayout.PREFERRED_SIZE, 103, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jScrollPane14, javax.swing.GroupLayout.PREFERRED_SIZE, 270, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(jLabel42)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel_MaKH1)
                                    .addComponent(jLabel39, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)))
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addGap(9, 9, 9)
                                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addComponent(TTHH_themHHmoi)
                                        .addGap(18, 18, 18)
                                        .addComponent(TTHH_suathongtin, javax.swing.GroupLayout.PREFERRED_SIZE, 165, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel1Layout.createSequentialGroup()
                                        .addGap(104, 104, 104)
                                        .addComponent(TTHH_huyluachon)))))
                        .addGap(139, 139, 139)
                        .addComponent(jScrollPane13, javax.swing.GroupLayout.PREFERRED_SIZE, 633, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(51, 51, 51))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addGap(262, 262, 262))))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout.createSequentialGroup()
                .addContainerGap(54, Short.MAX_VALUE)
                .addComponent(jLabel2)
                .addGap(18, 18, 18)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jLabel32)
                        .addGap(36, 36, 36)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(TTHH_mahang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel_MaKH1))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel39)
                            .addComponent(jScrollPane14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel42)
                            .addComponent(TTHH_loaihang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(21, 21, 21)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel44)
                            .addComponent(TTHH_giaban, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(25, 25, 25)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(TTHH_luu)
                            .addComponent(TTHH_huy))
                        .addGap(42, 42, 42)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(TTHH_themHHmoi)
                            .addComponent(TTHH_suathongtin))
                        .addGap(18, 18, 18)
                        .addComponent(TTHH_huyluachon))
                    .addComponent(jScrollPane13, javax.swing.GroupLayout.PREFERRED_SIZE, 522, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(107, 107, 107))
        );

        quanlydonhang.addTab("<html>\n<body>\n<br>\n<p>QUẢN LÝ HÀNG HÓA</p>\n<br>\n</body>\n</html>\n", jPanel1);

        jPanel_quanlykhohang.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        table_thongkekhohang.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_thongkekhohang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ HÀNG", "TÊN HÀNG", "SL TỒN"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_thongkekhohang.setRowHeight(25);
        table_thongkekhohang.setRowMargin(3);
        table_thongkekhohang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_thongkekhohangMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(table_thongkekhohang);
        if (table_thongkekhohang.getColumnModel().getColumnCount() > 0) {
            table_thongkekhohang.getColumnModel().getColumn(0).setPreferredWidth(40);
            table_thongkekhohang.getColumnModel().getColumn(1).setPreferredWidth(180);
            table_thongkekhohang.getColumnModel().getColumn(2).setPreferredWidth(15);
        }

        jLabel8.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel8.setText("THÔNG TIN KHO HÀNG");

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel10.setText("THÔNG TIN NHẬP KHO");

        jLabel11.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel11.setText("Mã Hàng");

        nhapkho_chonmahang.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        nhapkho_chonmahang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                nhapkho_chonmahangMouseClicked(evt);
            }
        });
        nhapkho_chonmahang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nhapkho_chonmahangActionPerformed(evt);
            }
        });

        button_nhapkho.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        button_nhapkho.setText("Nhập kho");
        button_nhapkho.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                button_nhapkhoActionPerformed(evt);
            }
        });

        nhapkho_soluongnhapkho.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N

        table_nhatkynhapkho.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_nhatkynhapkho.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "STT", "MÃ HÀNG", "SL", "NGÀY NHẬP"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_nhatkynhapkho.setRowHeight(25);
        table_nhatkynhapkho.setRowMargin(3);
        jScrollPane6.setViewportView(table_nhatkynhapkho);
        if (table_nhatkynhapkho.getColumnModel().getColumnCount() > 0) {
            table_nhatkynhapkho.getColumnModel().getColumn(0).setPreferredWidth(1);
            table_nhatkynhapkho.getColumnModel().getColumn(1).setPreferredWidth(80);
            table_nhatkynhapkho.getColumnModel().getColumn(2).setPreferredWidth(10);
            table_nhatkynhapkho.getColumnModel().getColumn(3).setPreferredWidth(60);
        }

        jLabel13.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel13.setText("LỊCH SỬ NHẬP KHO");

        jLabel12.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel12.setText("Số Lượng");

        nhapkho_tenhang.setColumns(20);
        nhapkho_tenhang.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        nhapkho_tenhang.setLineWrap(true);
        nhapkho_tenhang.setRows(3);
        nhapkho_tenhang.setWrapStyleWord(true);
        jScrollPane16.setViewportView(nhapkho_tenhang);

        jLabel50.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel50.setText("Tên Hàng");

        javax.swing.GroupLayout jPanel_quanlykhohangLayout = new javax.swing.GroupLayout(jPanel_quanlykhohang);
        jPanel_quanlykhohang.setLayout(jPanel_quanlykhohangLayout);
        jPanel_quanlykhohangLayout.setHorizontalGroup(
            jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel_quanlykhohangLayout.createSequentialGroup()
                .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addGap(58, 58, 58)
                        .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 614, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addGap(236, 236, 236)
                        .addComponent(jLabel8)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 71, Short.MAX_VALUE)
                .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 520, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(50, 50, 50))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jLabel12)
                            .addComponent(jLabel50)
                            .addComponent(jLabel11, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jScrollPane16, javax.swing.GroupLayout.PREFERRED_SIZE, 280, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(nhapkho_chonmahang, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(nhapkho_soluongnhapkho, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(button_nhapkho, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(104, 104, 104))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addComponent(jLabel10)
                        .addGap(201, 201, 201))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addComponent(jLabel13)
                        .addGap(210, 210, 210))))
        );
        jPanel_quanlykhohangLayout.setVerticalGroup(
            jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel_quanlykhohangLayout.createSequentialGroup()
                .addContainerGap(66, Short.MAX_VALUE)
                .addComponent(jLabel8)
                .addGap(18, 18, 18)
                .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel_quanlykhohangLayout.createSequentialGroup()
                        .addComponent(jLabel10)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(nhapkho_chonmahang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel11))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel50)
                            .addComponent(jScrollPane16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel_quanlykhohangLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(nhapkho_soluongnhapkho, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel12))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(button_nhapkho)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel13)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 245, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 557, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(60, 60, 60))
        );

        quanlydonhang.addTab("<html>\n<body>\n<br>\n<p>QUẢN LÝ KHO HÀNG</p>\n<br>\n</body>\n</html>\n", jPanel_quanlykhohang);

        jPanel2.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        CTDH_table.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        CTDH_table.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ HÀNG HOÁ", "TÊN HÀNG HOÁ", "SL", "GIÁ BÁN"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Integer.class, java.lang.Integer.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        CTDH_table.setRowHeight(25);
        CTDH_table.setRowMargin(3);
        jScrollPane1.setViewportView(CTDH_table);
        if (CTDH_table.getColumnModel().getColumnCount() > 0) {
            CTDH_table.getColumnModel().getColumn(0).setPreferredWidth(70);
            CTDH_table.getColumnModel().getColumn(1).setPreferredWidth(220);
            CTDH_table.getColumnModel().getColumn(2).setPreferredWidth(10);
            CTDH_table.getColumnModel().getColumn(3).setResizable(false);
            CTDH_table.getColumnModel().getColumn(3).setPreferredWidth(50);
        }

        CTDH_soluong.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N

        CTDH_giaban.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        CTDH_giaban.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                CTDH_giabanActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel1.setText("THÔNG TIN ĐƠN HÀNG MỚI");

        Tao_DH_moi.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        Tao_DH_moi.setText("Tạo Đơn Hàng");
        Tao_DH_moi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Tao_DH_moiActionPerformed(evt);
            }
        });

        jLabel3.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel3.setText("Mã Hàng Hóa:");

        jLabel4.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel4.setText("Số Lượng:");

        jLabel5.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel5.setText("Mã Khách Hàng:");

        Them_CTDH.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        Them_CTDH.setText("Thêm Chi Tiết Đơn Hàng");
        Them_CTDH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Them_CTDHActionPerformed(evt);
            }
        });

        Lammoi_CTDH.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        Lammoi_CTDH.setText("Hủy");
        Lammoi_CTDH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Lammoi_CTDHActionPerformed(evt);
            }
        });

        Xoa_dong_CTDH.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        Xoa_dong_CTDH.setText("Xóa");
        Xoa_dong_CTDH.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Xoa_dong_CTDHActionPerformed(evt);
            }
        });

        table_thongtinhanghoa.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_thongtinhanghoa.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ HÀNG HOÁ", "TÊN HÀNG HOÁ", "GIÁ BÁN", "SL TỒN"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_thongtinhanghoa.setRowHeight(25);
        table_thongtinhanghoa.setRowMargin(3);
        table_thongtinhanghoa.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_thongtinhanghoaMouseClicked(evt);
            }
        });
        jScrollPane4.setViewportView(table_thongtinhanghoa);
        if (table_thongtinhanghoa.getColumnModel().getColumnCount() > 0) {
            table_thongtinhanghoa.getColumnModel().getColumn(0).setPreferredWidth(60);
            table_thongtinhanghoa.getColumnModel().getColumn(1).setPreferredWidth(220);
            table_thongtinhanghoa.getColumnModel().getColumn(2).setPreferredWidth(40);
            table_thongtinhanghoa.getColumnModel().getColumn(3).setPreferredWidth(10);
        }

        chon_mahanghoa.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        chon_mahanghoa.setName(""); // NOI18N
        chon_mahanghoa.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chon_mahanghoaActionPerformed(evt);
            }
        });

        table_thongtinMaKH.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_thongtinMaKH.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ KH", "TÊN KHÁCH HÀNG", "SỐ ĐIỆN THOẠI"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_thongtinMaKH.setRowHeight(25);
        table_thongtinMaKH.setRowMargin(3);
        table_thongtinMaKH.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_thongtinMaKHMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(table_thongtinMaKH);
        if (table_thongtinMaKH.getColumnModel().getColumnCount() > 0) {
            table_thongtinMaKH.getColumnModel().getColumn(0).setPreferredWidth(10);
            table_thongtinMaKH.getColumnModel().getColumn(1).setPreferredWidth(180);
            table_thongtinMaKH.getColumnModel().getColumn(2).setPreferredWidth(50);
        }

        chon_makhachhang.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        chon_makhachhang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                chon_makhachhangActionPerformed(evt);
            }
        });

        jLabel7.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel7.setText("Người Lập Đơn:");

        text_tennguoilapHD.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N

        jLabel19.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel19.setText("DANH SÁCH KHÁCH HÀNG");

        jLabel46.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel46.setText("DANH SÁCH HÀNG HOÁ");

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel6.setText("Đơn Giá:");

        jLabel47.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel47.setText("Chi Tiết Đơn Hàng");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(61, 61, 61)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jScrollPane1)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                            .addGap(124, 124, 124)
                            .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 294, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(Them_CTDH, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addGap(132, 132, 132)
                                        .addComponent(jLabel5))
                                    .addComponent(jLabel4, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel3, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(jLabel6, javax.swing.GroupLayout.Alignment.TRAILING))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(CTDH_giaban, javax.swing.GroupLayout.PREFERRED_SIZE, 129, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chon_makhachhang, javax.swing.GroupLayout.PREFERRED_SIZE, 74, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(chon_mahanghoa, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(CTDH_soluong, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(2, 2, 2))))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel47)
                        .addGap(183, 183, 183)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 128, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(text_tennguoilapHD, javax.swing.GroupLayout.PREFERRED_SIZE, 222, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 52, Short.MAX_VALUE)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                            .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 567, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGap(43, 43, 43))
                        .addGroup(jPanel2Layout.createSequentialGroup()
                            .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 567, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addContainerGap()))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel46)
                        .addGap(209, 209, 209))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel19)
                        .addGap(189, 189, 189))))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(152, 152, 152)
                .addComponent(Xoa_dong_CTDH, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(Tao_DH_moi, javax.swing.GroupLayout.PREFERRED_SIZE, 172, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(Lammoi_CTDH, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addContainerGap(44, Short.MAX_VALUE)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel46)
                            .addComponent(jLabel1, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 235, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(10, 10, 10))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(92, 92, 92)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chon_makhachhang, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel5))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(chon_mahanghoa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel6)
                            .addComponent(CTDH_giaban, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel4)
                            .addComponent(CTDH_soluong, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(26, 26, 26)
                        .addComponent(Them_CTDH)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 34, Short.MAX_VALUE)))
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel7)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(text_tennguoilapHD, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel47))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 237, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(jLabel19)
                        .addGap(18, 18, 18)
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 240, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(Xoa_dong_CTDH)
                        .addComponent(Lammoi_CTDH))
                    .addComponent(Tao_DH_moi))
                .addContainerGap(41, Short.MAX_VALUE))
        );

        quanlydonhang.addTab("<html>\n<body>\n<br>\n<p>QUẢN LÝ ĐƠN HÀNG</p>\n<br>\n</body>\n</html>", jPanel2);

        jPanel5.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        table_thongtinkhachhang.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        table_thongtinkhachhang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ KHÁCH HÀNG", "TÊN KHÁCH HÀNG", "ĐỊA CHỈ", "SỐ ĐIỆN THOẠI"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_thongtinkhachhang.setRowHeight(25);
        table_thongtinkhachhang.setRowMargin(3);
        table_thongtinkhachhang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_thongtinkhachhangMouseClicked(evt);
            }
        });
        jScrollPane7.setViewportView(table_thongtinkhachhang);
        if (table_thongtinkhachhang.getColumnModel().getColumnCount() > 0) {
            table_thongtinkhachhang.getColumnModel().getColumn(0).setPreferredWidth(40);
            table_thongtinkhachhang.getColumnModel().getColumn(1).setPreferredWidth(80);
            table_thongtinkhachhang.getColumnModel().getColumn(2).setPreferredWidth(200);
            table_thongtinkhachhang.getColumnModel().getColumn(3).setPreferredWidth(50);
        }

        jLabel_MaKH.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel_MaKH.setText("Mã Khách Hàng:");

        jLabel20.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel20.setText("THÔNG TIN KHÁCH HÀNG");

        jLabel21.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel21.setText("Tên Khách Hàng:");

        jLabel22.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel22.setText("Địa Chỉ:");

        jLabel23.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel23.setText("Số Điện Thoại:");

        QLKH_suathongtin.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_suathongtin.setText("Sửa Thông Tin");
        QLKH_suathongtin.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                QLKH_suathongtinActionPerformed(evt);
            }
        });

        QLKH_huyluachon.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_huyluachon.setText("Hủy Lựa Chọn");
        QLKH_huyluachon.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                QLKH_huyluachonActionPerformed(evt);
            }
        });

        QLKH_huy.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_huy.setText("Xóa");
        QLKH_huy.setEnabled(false);
        QLKH_huy.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                QLKH_xoaActionPerformed(evt);
            }
        });

        QLKH_luu.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_luu.setText("Lưu");
        QLKH_luu.setEnabled(false);
        QLKH_luu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                QLKH_luuActionPerformed(evt);
            }
        });

        QLKH_themKHmoi.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_themKHmoi.setText("Thêm Khách Hàng");
        QLKH_themKHmoi.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                QLKH_themKHmoiActionPerformed(evt);
            }
        });

        QLKH_makh.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_makh.setEnabled(false);

        QLKH_tenkh.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_tenkh.setEnabled(false);

        QLKH_sdt.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_sdt.setEnabled(false);

        QLKH_diachi.setColumns(20);
        QLKH_diachi.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        QLKH_diachi.setLineWrap(true);
        QLKH_diachi.setRows(3);
        QLKH_diachi.setWrapStyleWord(true);
        QLKH_diachi.setEnabled(false);
        jScrollPane11.setViewportView(QLKH_diachi);

        jLabel45.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel45.setText("DANH SÁCH KHÁCH HÀNG");

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(108, 108, 108)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(QLKH_themKHmoi)
                            .addComponent(QLKH_luu, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(QLKH_huy, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(QLKH_suathongtin, javax.swing.GroupLayout.PREFERRED_SIZE, 183, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel5Layout.createSequentialGroup()
                                .addGap(66, 66, 66)
                                .addComponent(jLabel_MaKH))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jLabel23, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                                        .addComponent(jLabel22)
                                        .addGap(1, 1, 1)))))
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel5Layout.createSequentialGroup()
                                .addGap(17, 17, 17)
                                .addComponent(QLKH_makh, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel5Layout.createSequentialGroup()
                                .addGap(18, 18, 18)
                                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(QLKH_sdt, javax.swing.GroupLayout.PREFERRED_SIZE, 134, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jScrollPane11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(167, 167, 167)
                        .addComponent(jLabel20))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(228, 228, 228)
                        .addComponent(QLKH_huyluachon))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(58, 58, 58)
                        .addComponent(jLabel21)
                        .addGap(18, 18, 18)
                        .addComponent(QLKH_tenkh, javax.swing.GroupLayout.PREFERRED_SIZE, 286, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 88, Short.MAX_VALUE)
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 640, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(56, 56, 56))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(jLabel45)
                .addGap(248, 248, 248))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGap(43, 43, 43)
                .addComponent(jLabel45)
                .addGap(18, 18, 18)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel20)
                        .addGap(33, 33, 33)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(QLKH_makh, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel_MaKH))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(QLKH_tenkh, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel21))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel22)
                            .addComponent(jScrollPane11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel23)
                            .addComponent(QLKH_sdt, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(26, 26, 26)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(QLKH_luu)
                            .addComponent(QLKH_huy))
                        .addGap(29, 29, 29)
                        .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(QLKH_themKHmoi)
                            .addComponent(QLKH_suathongtin))
                        .addGap(18, 18, 18)
                        .addComponent(QLKH_huyluachon))
                    .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 482, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(158, Short.MAX_VALUE))
        );

        quanlydonhang.addTab("<html> <body> <br> <p>QUẢN LÝ KHÁCH HÀNG</p> <br> </body> </html>", jPanel5);

        jPanel4.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        table_thongtindonhang.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_thongtindonhang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ SỐ", "TÊN HÀNG", "SL", "GIÁ BÁN", "THÀNH TIỀN"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_thongtindonhang.setRowHeight(25);
        table_thongtindonhang.setRowMargin(3);
        table_thongtindonhang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_thongtindonhangMouseClicked(evt);
            }
        });
        jScrollPane10.setViewportView(table_thongtindonhang);
        if (table_thongtindonhang.getColumnModel().getColumnCount() > 0) {
            table_thongtindonhang.getColumnModel().getColumn(0).setPreferredWidth(30);
            table_thongtindonhang.getColumnModel().getColumn(1).setPreferredWidth(180);
            table_thongtindonhang.getColumnModel().getColumn(2).setPreferredWidth(0);
            table_thongtindonhang.getColumnModel().getColumn(3).setPreferredWidth(60);
            table_thongtindonhang.getColumnModel().getColumn(4).setPreferredWidth(80);
        }

        table_danhsachdonhang.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        table_danhsachdonhang.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "MÃ ĐH", "KHÁCH HÀNG", "NGÀY LẬP", "NGƯỜI LẬP", "TỔNG TIỀN"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        table_danhsachdonhang.setRowHeight(25);
        table_danhsachdonhang.setRowMargin(3);
        table_danhsachdonhang.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                table_danhsachdonhangMouseClicked(evt);
            }
        });
        jScrollPane12.setViewportView(table_danhsachdonhang);
        if (table_danhsachdonhang.getColumnModel().getColumnCount() > 0) {
            table_danhsachdonhang.getColumnModel().getColumn(0).setPreferredWidth(10);
            table_danhsachdonhang.getColumnModel().getColumn(1).setPreferredWidth(80);
            table_danhsachdonhang.getColumnModel().getColumn(2).setPreferredWidth(40);
            table_danhsachdonhang.getColumnModel().getColumn(3).setPreferredWidth(80);
            table_danhsachdonhang.getColumnModel().getColumn(4).setPreferredWidth(40);
        }

        jLabel18.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel18.setText("CHI TIẾT ĐƠN HÀNG");

        jLabel24.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel24.setText("Tổng Tiền:");

        tongtien.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        tongtien.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        tongtien.setText("000000");

        jLabel33.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel33.setText("VNĐ");

        Xemtatcadonhang.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        Xemtatcadonhang.setText("Thống Kê Tất Cả ");
        Xemtatcadonhang.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                XemtatcadonhangActionPerformed(evt);
            }
        });

        thongtindonhang_month.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        thongtindonhang_month.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Tất cả", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12" }));

        jLabel34.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel34.setText("Tháng:");

        jLabel35.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel35.setText("Năm:");

        Xemtheothangvanam.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        Xemtheothangvanam.setText("Thống Kê Theo Tháng / Năm");
        Xemtheothangvanam.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                XemtheothangvanamActionPerformed(evt);
            }
        });

        jLabel36.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel36.setText("DANH SÁCH ĐƠN HÀNG");

        jLabel37.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel37.setText("Mã Đơn Hàng");

        thongtindonhang_madh.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        thongtindonhang_madh.setText("MaDH");

        thongtindonhang_year.setBackground(new java.awt.Color(240, 240, 240));
        thongtindonhang_year.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N

        jLabel38.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel38.setText("Tổng Doanh Thu:");

        doanhthu.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        doanhthu.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        doanhthu.setText("000000000000");

        jLabel40.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel40.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel40.setText("VNĐ");
        jLabel40.setToolTipText("");

        jLabel41.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel41.setText("Số Lượng Đơn Hàng:");

        SL_donhang.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        SL_donhang.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        SL_donhang.setText("00");

        jLabel43.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel43.setText("THỜI GIAN:");

        danhsachdonhang_thoigian.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        danhsachdonhang_thoigian.setText("ALL / nam");

        jLabel48.setFont(new java.awt.Font("Tahoma", 1, 20)); // NOI18N
        jLabel48.setText("THỐNG KÊ ");

        jLabel9.setFont(new java.awt.Font("Tahoma", 0, 16)); // NOI18N
        jLabel9.setText("Đơn");

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(225, 225, 225)
                .addComponent(jLabel36)
                .addGap(0, 0, Short.MAX_VALUE))
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(jPanel4Layout.createSequentialGroup()
                            .addGap(42, 42, 42)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jScrollPane12, javax.swing.GroupLayout.PREFERRED_SIZE, 613, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jLabel43)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(danhsachdonhang_thoigian))))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                            .addGap(383, 383, 383)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jLabel41, javax.swing.GroupLayout.PREFERRED_SIZE, 150, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(SL_donhang, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jLabel38)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(doanhthu)))
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(jLabel9)))
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, jPanel4Layout.createSequentialGroup()
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel40, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 65, Short.MAX_VALUE)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addComponent(jLabel24)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(tongtien, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jLabel33)
                        .addGap(55, 55, 55))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                            .addComponent(jLabel37)
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jLabel18)
                                    .addGap(216, 216, 216))
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(thongtindonhang_madh, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addContainerGap())))
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                            .addComponent(jScrollPane10, javax.swing.GroupLayout.PREFERRED_SIZE, 548, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGap(45, 45, 45)))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addComponent(Xemtatcadonhang)
                        .addGap(245, 245, 245))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(Xemtheothangvanam, javax.swing.GroupLayout.PREFERRED_SIZE, 244, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addComponent(jLabel34)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(thongtindonhang_month, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(jLabel35))
                                    .addComponent(jLabel48, javax.swing.GroupLayout.PREFERRED_SIZE, 110, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(thongtindonhang_year, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(203, 203, 203))))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGap(60, 60, 60)
                .addComponent(jLabel36)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(8, 8, 8)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel43)
                            .addComponent(danhsachdonhang_thoigian))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jScrollPane12, javax.swing.GroupLayout.DEFAULT_SIZE, 484, Short.MAX_VALUE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(14, 14, 14)
                        .addComponent(jLabel48)
                        .addGap(18, 18, 18)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel34)
                            .addComponent(thongtindonhang_month, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel35)
                            .addComponent(thongtindonhang_year, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addComponent(Xemtheothangvanam)
                        .addGap(18, 18, 18)
                        .addComponent(Xemtatcadonhang)
                        .addGap(34, 34, 34)
                        .addComponent(jLabel18)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel37, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(thongtindonhang_madh))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jScrollPane10, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)))
                .addGap(21, 21, 21)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel41)
                    .addComponent(SL_donhang)
                    .addComponent(jLabel9)
                    .addComponent(tongtien)
                    .addComponent(jLabel33)
                    .addComponent(jLabel24))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE, false)
                    .addComponent(jLabel38, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(doanhthu, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel40))
                .addGap(56, 56, 56))
        );

        quanlydonhang.addTab("<html> <body> <br> <p>THỐNG KÊ ĐƠN HÀNG</p> <br> </body> </html>", jPanel4);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel25)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 830, Short.MAX_VALUE)
                .addComponent(changePWD)
                .addGap(19, 19, 19))
            .addGroup(layout.createSequentialGroup()
                .addComponent(quanlydonhang, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel25)
                    .addComponent(changePWD))
                .addGap(14, 14, 14)
                .addComponent(quanlydonhang, javax.swing.GroupLayout.PREFERRED_SIZE, 733, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        quanlydonhang.getAccessibleContext().setAccessibleName("");

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void quanlydonhangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_quanlydonhangMouseClicked
       
        // TODO add your handling code here:
    }//GEN-LAST:event_quanlydonhangMouseClicked

    private void button_nhapkhoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_button_nhapkhoActionPerformed
        try {

            //1. tao noi ket
            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            Connection conn = null;
            conn = (Connection) DriverManager.getConnection(connStr);
           
            String sql = "call nhapkho(\"" + nhapkho_chonmahang.getSelectedItem() + "\",\"" + nhapkho_soluongnhapkho.getText() + "\")";
            Statement stmt = conn.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            
            JOptionPane.showMessageDialog(this, "Nhập kho thành công: \n Mã hàng: " + nhapkho_chonmahang.getSelectedItem()
                    + "\n Tên Hàng: "+ nhapkho_tenhang.getText()
                    + "\n Số lượng: " + nhapkho_soluongnhapkho.getText());
            click = 0;
            lammoi();
            
            nhapkho_soluongnhapkho.setText("");
            
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, "Lỗi! Không thể nhập kho!");
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_button_nhapkhoActionPerformed

    private void table_thongkekhohangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_thongkekhohangMouseClicked
        nhapkho_chonmahang.setSelectedIndex(table_thongkekhohang.getSelectedRow());
        int n = table_thongkekhohang.getSelectedRow();
        nhapkho_tenhang.setText((String)table_thongkekhohang.getValueAt(n,1));

        //JOptionPane.showMessageDialog(this, "dang chon dong "+table_thongkekhohang.getSelectedRow() );         // TODO add your handling code here:
    }//GEN-LAST:event_table_thongkekhohangMouseClicked

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        lammoi();

    // TODO add your handling code here:
    }//GEN-LAST:event_formWindowOpened

    private void table_danhsachdonhangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_danhsachdonhangMouseClicked

        DefaultTableModel table1;
        table1 = (DefaultTableModel) table_thongtindonhang.getModel();
        ArrayList<thongtindonhang> list1 = new ArrayList();

        try {
            int n = table_danhsachdonhang.getSelectedRow();
            thongtindonhang_madh.setText((String) table_danhsachdonhang.getValueAt(n, 0));
            String tenkh = (String)table_danhsachdonhang.getValueAt(n, 1);
            table_danhsachdonhang.setToolTipText(tenkh);
            String madh = thongtindonhang_madh.getText();

            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            Connection conn = null;
            conn = (Connection) DriverManager.getConnection(connStr);
            String sql1 = "select a.cthd_maso, b.tenhang, a.soluong, a.dongia, a.soluong * a.dongia as 'thanhtien'"
                    + "from chitiethoadon a, hanghoa b "
                    + "where  a.mahang=b.mahang and a.mahd like '" + madh + "'";
            Statement stmt1 = conn.createStatement();
            ResultSet rs1 = stmt1.executeQuery(sql1);
            while (rs1.next()) {
                thongtindonhang ttdh = new thongtindonhang();
                ttdh.setMaso(rs1.getString(1));
                ttdh.setTenhang(rs1.getString(2));
                ttdh.setSoluong(rs1.getString(3));
                ttdh.setDongia(rs1.getString(4));
                ttdh.setThanhtien(rs1.getString(5));
                list1.add(ttdh);
            }

            table1.setRowCount(0);
            for (Object thongtindonhang : list1) {
                Object[] obj1 = {
                    ((thongtindonhang) thongtindonhang).getMaso(),
                    ((thongtindonhang) thongtindonhang).getTenhang(),
                    ((thongtindonhang) thongtindonhang).getSoluong(),
                    ((thongtindonhang) thongtindonhang).getDongia(),
                    ((thongtindonhang) thongtindonhang).getThanhtien(),};
                table1.addRow(obj1);
            }
            int tongtien = 0;
            String tt;
            for (int i = 0; i < table_thongtindonhang.getRowCount(); i++) {
                tt = (String) table_thongtindonhang.getValueAt(i, 4);
                tongtien += Integer.parseInt(tt);

            }
            this.tongtien.setText("" + tongtien);

        } catch (Exception e) {
            System.out.println("Khong the noi ket");

        }
//
//

        // TODO add your handling code here:
    }//GEN-LAST:event_table_danhsachdonhangMouseClicked

    private void XemtatcadonhangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_XemtatcadonhangActionPerformed
        DefaultTableModel table1, table2;
        Connection conn = null;
        try {
            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            conn = (Connection) DriverManager.getConnection(connStr);
            try {

                table1 = (DefaultTableModel) table_danhsachdonhang.getModel();
                ArrayList<danhsachdonhang> list6 = new ArrayList();
                String sql5 = "select a.mahd, b.hoten, a.ngaylap, a.nguoilaphd, sum(c.soluong*c.dongia) as tongtien\n"
                        + "from hoadon a, khachhang b, chitiethoadon c\n"
                        + "where a.makh=b.makh and a.mahd=c.mahd\n"
                        + "group by a.mahd\n"
                        + "ORDER by CONVERT(SUBSTRING_INDEX(a.mahd,\"HD\",-1),UNSIGNED INTEGER) DESC";
                Statement stmt5 = conn.createStatement();
                ResultSet rs5 = stmt5.executeQuery(sql5);
                while (rs5.next()) {
                    danhsachdonhang dsdh = new danhsachdonhang();
                    dsdh.setMaDH(rs5.getString(1));
                    dsdh.setKhachhang(rs5.getString(2));
                    dsdh.setNgaylap(rs5.getString(3));
                    dsdh.setNguoilap(rs5.getString(4));
                    dsdh.setTongtien(rs5.getString(5));
                    list6.add(dsdh);

                }
                table1.setRowCount(0);
                for (Object danhsachdonhang : list6) {
                    Object[] obj6 = {
                        ((danhsachdonhang) danhsachdonhang).getMaDH(),
                        ((danhsachdonhang) danhsachdonhang).getKhachhang(),
                        ((danhsachdonhang) danhsachdonhang).getNgaylap(),
                        ((danhsachdonhang) danhsachdonhang).getNguoilap(),
                        ((danhsachdonhang) danhsachdonhang).getTongtien()
                    };
                    table1.addRow(obj6);
                }
                int doanhthu = 0;
                String tongtien;
                this.SL_donhang.setText("" + table_danhsachdonhang.getRowCount());
                this.danhsachdonhang_thoigian.setText("Tất cả / Năm");
                for (int i = 0; i < table_danhsachdonhang.getRowCount(); i++) {
                    tongtien = (String) table_danhsachdonhang.getValueAt(i, 4);
                    doanhthu += Integer.parseInt(tongtien);

                }
                this.doanhthu.setText("" + doanhthu);

            } catch (SQLException e) {
                System.out.println("Truy van khong thanh cong");
                System.out.println("Error: " + e.getMessage());
            }
            table2 = (DefaultTableModel) table_thongtindonhang.getModel();
            table2.setRowCount(0);
            this.tongtien.setText("");
            this.thongtindonhang_madh.setText("");
            thongtindonhang_month.setSelectedIndex(0);
            thongtindonhang_year.setText("");

        } catch (Exception e) {
            System.out.println("Khong the noi ket");
            System.out.println(e.getMessage());
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_XemtatcadonhangActionPerformed

    private void XemtheothangvanamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_XemtheothangvanamActionPerformed

        DefaultTableModel table1, table2;
        Connection conn = null;
        try {
            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            conn = (Connection) DriverManager.getConnection(connStr);
            try {
                if (this.thongtindonhang_month.getSelectedIndex() == 0) {
                    //JOptionPane.showMessageDialog(this, "all");
                    String sql = "select a.mahd, b.hoten, a.ngaylap, a.nguoilaphd, sum(c.soluong*c.dongia) as tongtien\n"
                            + "from hoadon a, khachhang b, chitiethoadon c\n"
                            + "where a.makh=b.makh and a.mahd=c.mahd\n"
                            + " and year(a.ngaylap)= " + this.thongtindonhang_year.getText() + "\n"
                            + "group by a.mahd\n"
                            + "ORDER by CONVERT(SUBSTRING_INDEX(a.mahd,\"HD\",-1),UNSIGNED INTEGER) DESC";
                    table1 = (DefaultTableModel) table_danhsachdonhang.getModel();
                    ArrayList<danhsachdonhang> list6 = new ArrayList();
                    Statement stmt5 = conn.createStatement();
                    ResultSet rs5 = stmt5.executeQuery(sql);
                    while (rs5.next()) {
                        danhsachdonhang dsdh = new danhsachdonhang();
                        dsdh.setMaDH(rs5.getString(1));
                        dsdh.setKhachhang(rs5.getString(2));
                        dsdh.setNgaylap(rs5.getString(3));
                        dsdh.setNguoilap(rs5.getString(4));
                        dsdh.setTongtien(rs5.getString(5));
                        list6.add(dsdh);

                    }
                    table1.setRowCount(0);
                    for (Object danhsachdonhang : list6) {
                        Object[] obj6 = {
                            ((danhsachdonhang) danhsachdonhang).getMaDH(),
                            ((danhsachdonhang) danhsachdonhang).getKhachhang(),
                            ((danhsachdonhang) danhsachdonhang).getNgaylap(),
                            ((danhsachdonhang) danhsachdonhang).getNguoilap(),
                            ((danhsachdonhang) danhsachdonhang).getTongtien()
                        };
                        table1.addRow(obj6);
                    }
                    int doanhthu = 0;
                    String tongtien;
                    this.SL_donhang.setText("" + table_danhsachdonhang.getRowCount());
                    this.danhsachdonhang_thoigian.setText("Tất cả / " + this.thongtindonhang_year.getText());
                    for (int i = 0; i < table_danhsachdonhang.getRowCount(); i++) {
                        tongtien = (String) table_danhsachdonhang.getValueAt(i, 4);
                        doanhthu += Integer.parseInt(tongtien);

                    }
                    this.doanhthu.setText("" + doanhthu);
                } else {
                    //            JOptionPane.showMessageDialog(this, "Thang "+this.thongtindonhang_month.getSelectedItem());
                    String sql = "select a.mahd, b.hoten, a.ngaylap, a.nguoilaphd, sum(c.soluong*c.dongia) as tongtien\n"
                            + "from hoadon a, khachhang b, chitiethoadon c\n"
                            + "where a.makh=b.makh and a.mahd=c.mahd\n"
                            + "and month(a.ngaylap)= " + this.thongtindonhang_month.getSelectedItem() + " and year(a.ngaylap)= " + this.thongtindonhang_year.getText() + "\n"
                            + "group by a.mahd\n"
                            + "ORDER by CONVERT(SUBSTRING_INDEX(a.mahd,\"HD\",-1),UNSIGNED INTEGER) DESC";
                    table1 = (DefaultTableModel) table_danhsachdonhang.getModel();
                    ArrayList<danhsachdonhang> list6 = new ArrayList();
                    Statement stmt5 = conn.createStatement();
                    ResultSet rs5 = stmt5.executeQuery(sql);
                    while (rs5.next()) {
                        danhsachdonhang dsdh = new danhsachdonhang();
                        dsdh.setMaDH(rs5.getString(1));
                        dsdh.setKhachhang(rs5.getString(2));
                        dsdh.setNgaylap(rs5.getString(3));
                        dsdh.setNguoilap(rs5.getString(4));
                        dsdh.setTongtien(rs5.getString(5));
                        list6.add(dsdh);

                    }
                    table1.setRowCount(0);
                    for (Object danhsachdonhang : list6) {
                        Object[] obj6 = {
                            ((danhsachdonhang) danhsachdonhang).getMaDH(),
                            ((danhsachdonhang) danhsachdonhang).getKhachhang(),
                            ((danhsachdonhang) danhsachdonhang).getNgaylap(),
                            ((danhsachdonhang) danhsachdonhang).getNguoilap(),
                            ((danhsachdonhang) danhsachdonhang).getTongtien()
                        };
                        table1.addRow(obj6);
                    }
                    int doanhthu = 0;
                    String tongtien;
                    this.SL_donhang.setText("" + table_danhsachdonhang.getRowCount());
                    this.danhsachdonhang_thoigian.setText("Tháng "+this.thongtindonhang_month.getSelectedItem() + " / " + this.thongtindonhang_year.getText());
                    for (int i = 0; i < table_danhsachdonhang.getRowCount(); i++) {
                        tongtien = (String) table_danhsachdonhang.getValueAt(i, 4);
                        doanhthu += Integer.parseInt(tongtien);

                    }
                    this.doanhthu.setText("" + doanhthu);
                }

            } catch (SQLException e) {
                System.out.println("Truy van khong thanh cong");
                System.out.println("Error: " + e.getMessage());
                JOptionPane.showMessageDialog(this, "Chưa chọn Năm");
            }
            table2 = (DefaultTableModel) table_thongtindonhang.getModel();
            table2.setRowCount(0);
            this.tongtien.setText("");
            this.thongtindonhang_madh.setText("");

        } catch (Exception e) {
            System.out.println("Khong the noi ket");
            System.out.println(e.getMessage());
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_XemtheothangvanamActionPerformed

    private void TTHH_suathongtinActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TTHH_suathongtinActionPerformed
        
        try{
            int n = table_hanghoa.getSelectedRow();
            TTHH_mahang.setText((String)table_hanghoa.getValueAt(n,0));

            TTHH_luu.setEnabled(true);
            TTHH_huy.setEnabled(true);
            TTHH_themHHmoi.setEnabled(false);
            TTHH_mahang.setEnabled(false);

            TTHH_loaihang.setEnabled(true);
            TTHH_tenhang.setEnabled(true);
            TTHH_giaban.setEnabled(true);
            suathongtinHH = 1;
        }catch(Exception e){
            JOptionPane.showMessageDialog(this,"Xin hãy chọn Hàng hóa cần chỉnh sửa!");
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_TTHH_suathongtinActionPerformed

    private void TTHH_huyluachonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TTHH_huyluachonActionPerformed
        themHHmoi=0;
        suathongtinHH=0;
        table_hanghoa.clearSelection();
        TTHH_mahang.setText("");
        TTHH_tenhang.setText("");
        TTHH_giaban.setText("");
        TTHH_mahang.setEnabled(false);
        TTHH_tenhang.setEnabled(false);
        TTHH_giaban.setEnabled(false);
        TTHH_loaihang.setEnabled(false);
        TTHH_themHHmoi.setEnabled(true);
        TTHH_suathongtin.setEnabled(true);
        table_hanghoa.setEnabled(true);
        TTHH_luu.setEnabled(false);
        TTHH_huy.setEnabled(false);
        // TODO add your handling code here:
    }//GEN-LAST:event_TTHH_huyluachonActionPerformed

    private void TTHH_xoaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TTHH_xoaActionPerformed
        
        
        TTHH_tenhang.setText("");
        TTHH_giaban.setText("");
        
        if(themHHmoi==0)    
        table_hanghoa.setEnabled(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_TTHH_xoaActionPerformed

    private void TTHH_luuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TTHH_luuActionPerformed
        int stt = table_hanghoa.getSelectedRow();
        
            if (themHHmoi == 1) {
                try {
                    Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                    String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                    Connection conn = null;
                    conn = (Connection) DriverManager.getConnection(connStr);

                    String sql1 = "call themhanghoamoi(\"" + TTHH_mahang.getText() + "\",\"" + TTHH_tenhang.getText() + "\",\"" + TTHH_loaihang.getSelectedItem() + "\",\"" + TTHH_giaban.getText() + "\")";
                    Statement stmt1 = conn.createStatement();
                    stmt1.executeQuery(sql1);
                    JOptionPane.showMessageDialog(this, "Thêm thành công:  \n Mã hàng: " + TTHH_mahang.getText() + "\n Tên hàng: " + TTHH_tenhang.getText() + "\n Loại hàng: " + TTHH_loaihang.getSelectedItem() + "\n Giá bán: " + TTHH_giaban.getText() + ".");
                    lammoi();
                    themHHmoi = 0;
                    
                } catch (Exception e) {
                    System.out.println("Khong the noi ket");
                    System.out.println(e.getMessage());
                    JOptionPane.showMessageDialog(this, "Thêm hàng hóa thất bại!");
                    
                }

            }
        
        if (suathongtinHH == 1) {

            try {
                Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                Connection conn = null;
                conn = (Connection) DriverManager.getConnection(connStr);
//           
//                
                String sql3 = "call suathongtinHH(\"" + TTHH_mahang.getText() + "\",\"" + TTHH_tenhang.getText() + "\",\"" + TTHH_loaihang.getSelectedItem() + "\",\"" + TTHH_giaban.getText() + "\")";
                Statement stmt3 = conn.createStatement();
                stmt3.executeQuery(sql3);
//
//
                JOptionPane.showMessageDialog(this, "Sửa thông tin thành công:  \n Mã hàng: " + TTHH_mahang.getText() + "\n Tên hàng: " + TTHH_tenhang.getText() + "\n Loại hàng: " + TTHH_loaihang.getSelectedItem() + "\n Giá bán: " + TTHH_giaban.getText() + ".");
                lammoi();
                suathongtinHH = 0;
                table_hanghoa.setRowSelectionInterval(stt, stt);

            } catch (Exception e) {
                System.out.println("Khong the noi ket");
                System.out.println(e.getMessage());
                JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
            }
        }
        if(themHHmoi == 0) {
            table_hanghoa.setEnabled(true);
        }
        TTHH_mahang.setText("");
        TTHH_tenhang.setText("");
        TTHH_giaban.setText("");
        
        TTHH_luu.setEnabled(false);
        TTHH_huy.setEnabled(false);
        TTHH_themHHmoi.setEnabled(true);
        TTHH_suathongtin.setEnabled(true);
        TTHH_mahang.setEnabled(false);
        TTHH_tenhang.setEnabled(false);
        TTHH_loaihang.setEnabled(false);
        TTHH_giaban.setEnabled(false);
        
        // TODO add your handling code here:
    }//GEN-LAST:event_TTHH_luuActionPerformed

    private void TTHH_themHHmoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_TTHH_themHHmoiActionPerformed
        TTHH_huy.setEnabled(true);
        TTHH_luu.setEnabled(true);
        themHHmoi = 1;
        
        TTHH_suathongtin.setEnabled(false);
      
        TTHH_mahang.setEnabled(true);
        TTHH_tenhang.setEnabled(true);
        TTHH_loaihang.setEnabled(true);
        TTHH_giaban.setEnabled(true);
        TTHH_mahang.setText("");
        TTHH_tenhang.setText("");
        TTHH_giaban.setText("");
        table_hanghoa.clearSelection();
        table_hanghoa.setEnabled(false);

// TODO add your handling code here:
    }//GEN-LAST:event_TTHH_themHHmoiActionPerformed

    private void unblock_changePWDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_unblock_changePWDActionPerformed
        if (thaydoimatkhau == 0) {
            try {

                Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                Connection conn = DriverManager.getConnection(connStr);
                String matkhau = null;
                String sql1 = "select matkhau from matkhau";
                Statement stmt1 = conn.createStatement();
                ResultSet rs1 = stmt1.executeQuery(sql1);
                while (rs1.next()) {
                    matkhau = rs1.getString(1);
                }
                String nhapmatkhau = nhap_matkhau.getText();
                if (nhap_matkhau.getText().equals(matkhau)) {
                    quanlydonhang.setEnabled(true);
                    unblock_changePWD.setEnabled(false);
                    
                    nhap_matkhau.setEnabled(false);
                    changePWD.setEnabled(true);
                    nhap_matkhau.setText("");
                    jlogin.setVisible(false);
                    jGTChucNang.setVisible(true);
                } else {
                    JOptionPane.showMessageDialog(this, "Sai mật khẩu");
                }
            } catch (Exception e) {
                System.out.println("Khong the noi ket");
                System.out.println(e.getMessage());
                JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
            }
        } else {
            try {
                Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                Connection conn = DriverManager.getConnection(connStr);
                String matkhau = null;
                matkhau = nhap_matkhau.getText();
                String sql2 = "call doimatkhau(\"" + matkhau + "\")";//"UPDATE dlphanbon.matkhau SET matkhau.matkhau=\""+ matkhau + "\" where matkhau.taikhoan = \"dlphanbon\"";
                Statement stmt2 = conn.createStatement();
                stmt2.executeQuery(sql2);
                JOptionPane.showMessageDialog(this, "Đã đổi mật khẩu");
                changePWD.setText("Đổi mật khẩu");
                unblock_changePWD.setText("Mở khoá");
                label_matkhau.setText("Nhập mật khẩu để mở khoá");
                
                thaydoimatkhau = 0;
                nhap_matkhau.setText("");
                
                jlogin.setVisible(true);
                
                
            } catch (Exception e) {
                System.out.println("Khong the noi ket");
                System.out.println(e.getMessage());
                JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
            }
            
        }
// TODO add your handling code here:
    }//GEN-LAST:event_unblock_changePWDActionPerformed

    int thaydoimatkhau = 0;
    private void changePWDActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_changePWDActionPerformed
        quanlydonhang.setSelectedIndex(0);
        jlogin.setVisible(true);
        jGTChucNang.setVisible(false);
        if (thaydoimatkhau == 0) {
            changePWD.setText("Huỷ");
            unblock_changePWD.setText("Đổi mật khẩu");
            label_matkhau.setText("Nhập mật khẩu mới");
            nhap_matkhau.setText("");
            unblock_changePWD.setEnabled(true);
            nhap_matkhau.setEnabled(true);
            thaydoimatkhau = 1;
            quanlydonhang.setEnabled(false);
            
        } else {
            changePWD.setText("Đổi mật khẩu");
            unblock_changePWD.setText("Mở khoá");
            label_matkhau.setText("Nhập mật khẩu để mở khoá");
            unblock_changePWD.setEnabled(false);
            nhap_matkhau.setEnabled(false);
            thaydoimatkhau = 0;
            quanlydonhang.setEnabled(true);
            nhap_matkhau.setText("");
            jlogin.setVisible(false);
            jGTChucNang.setVisible(true);
        }


// TODO add your handling code here:
    }//GEN-LAST:event_changePWDActionPerformed

    private void QLKH_themKHmoiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_QLKH_themKHmoiActionPerformed
        themKHmoi = 1;
        QLKH_luu.setEnabled(true);
        QLKH_huy.setEnabled(true);
        
        QLKH_suathongtin.setEnabled(false);
        
        QLKH_diachi.setEnabled(true);
        QLKH_tenkh.setEnabled(true);
        QLKH_sdt.setEnabled(true);
        QLKH_makh.setEnabled(false);
        int n = table_thongtinkhachhang.getRowCount();
        String makhachhang="KH"+(n+1);
        QLKH_makh.setText(makhachhang);
        QLKH_tenkh.setText("");
        QLKH_diachi.setText("");
        QLKH_sdt.setText("");
        table_thongtinkhachhang.clearSelection();
        table_thongtinkhachhang.setEnabled(false);
        // TODO add your handling code here:
    }//GEN-LAST:event_QLKH_themKHmoiActionPerformed

    private void QLKH_luuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_QLKH_luuActionPerformed
        int stt = table_thongtinkhachhang.getSelectedRow();

        if (themKHmoi == 1) {
            try {
                Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                Connection conn = null;
                conn = (Connection) DriverManager.getConnection(connStr);

                String sql1 = "call themkhachhangmoi(\"" + QLKH_tenkh.getText() + "\",\"" + QLKH_diachi.getText() + "\",\"" + QLKH_sdt.getText() + "\")";
                Statement stmt1 = conn.createStatement();
                stmt1.executeQuery(sql1);

                String sql2 = "SELECT * FROM khachhang ORDER BY maKH DESC limit 1 ;";
                Statement stmt2 = conn.createStatement();
                ResultSet rs2 = stmt2.executeQuery(sql2);
                rs2.next();
                String maKH = rs2.getString(1);
                String tenKH = rs2.getString(2);

                JOptionPane.showMessageDialog(this, "Thêm thành công:\n Mã KH: " + maKH
                    + "\n Tên KH:  " + QLKH_tenkh.getText()
                    + "\n Địa chỉ: " + QLKH_diachi.getText()
                    + "\n SĐT: " + QLKH_sdt.getText());
                lammoi();
                themKHmoi = 0;

            } catch (Exception e) {
                System.out.println("Khong the noi ket");
                System.out.println(e.getMessage());
                JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
            }

        }
        if (suathongtin == 1) {

            try {
                Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                Connection conn = null;
                conn = (Connection) DriverManager.getConnection(connStr);

                String sql3 = "call suathongtin(\"" + QLKH_makh.getText()
                + "\",\"" + QLKH_tenkh.getText()
                + "\",\"" + QLKH_diachi.getText()
                + "\",\"" + QLKH_sdt.getText() + "\")";
                Statement stmt3 = conn.createStatement();
                stmt3.executeQuery(sql3);

                JOptionPane.showMessageDialog(this, "Sửa thông tin thành công:\n Mã KH: " + QLKH_makh.getText()
                    + "\n Tên KH:  " + QLKH_tenkh.getText()
                    + "\n Địa chỉ: " + QLKH_diachi.getText()
                    + "\n SĐT: " + QLKH_sdt.getText());
                lammoi();
                suathongtin = 0;
                table_thongtinkhachhang.setRowSelectionInterval(stt, stt);

            } catch (Exception e) {
                System.out.println("Khong the noi ket");
                System.out.println(e.getMessage());
                JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
            }
        }
        QLKH_makh.setText("");
        QLKH_tenkh.setText("");
        QLKH_diachi.setText("");
        QLKH_sdt.setText("");
        QLKH_luu.setEnabled(false);
        QLKH_huy.setEnabled(false);
        QLKH_themKHmoi.setEnabled(true);
        QLKH_suathongtin.setEnabled(true);
        QLKH_huyluachon.setEnabled(true);
        QLKH_diachi.setEnabled(false);
        QLKH_tenkh.setEnabled(false);
        QLKH_sdt.setEnabled(false);
        table_thongtinkhachhang.setEnabled(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_QLKH_luuActionPerformed

    private void QLKH_xoaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_QLKH_xoaActionPerformed
        
        
        QLKH_tenkh.setText("");
        QLKH_diachi.setText("");
        QLKH_sdt.setText("");
        if(themKHmoi == 0)
        table_thongtinkhachhang.setEnabled(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_QLKH_xoaActionPerformed

    private void QLKH_huyluachonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_QLKH_huyluachonActionPerformed
        themKHmoi=0;
        suathongtin=0;
        table_thongtinkhachhang.clearSelection();
        QLKH_makh.setText("");
        QLKH_tenkh.setText("");
        QLKH_diachi.setText("");
        QLKH_sdt.setText("");
        QLKH_luu.setEnabled(false);
        QLKH_huy.setEnabled(false);
        QLKH_themKHmoi.setEnabled(true);
        QLKH_makh.setEnabled(false);
        QLKH_tenkh.setEnabled(false);
        QLKH_diachi.setEnabled(false);
        QLKH_sdt.setEnabled(false);
        QLKH_suathongtin.setEnabled(true);
        table_thongtinkhachhang.setEnabled(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_QLKH_huyluachonActionPerformed

    private void QLKH_suathongtinActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_QLKH_suathongtinActionPerformed

        try{
            int n = table_thongtinkhachhang.getSelectedRow();
            
            QLKH_makh.setText((String) table_thongtinkhachhang.getValueAt(n, 0));
            QLKH_tenkh.setText((String) table_thongtinkhachhang.getValueAt(n, 1));
            QLKH_diachi.setText((String) table_thongtinkhachhang.getValueAt(n, 2));
            QLKH_sdt.setText((String) table_thongtinkhachhang.getValueAt(n, 3));
            QLKH_luu.setEnabled(true);
            QLKH_huy.setEnabled(true);
            QLKH_themKHmoi.setEnabled(false);

            QLKH_makh.setEnabled(false);
            QLKH_diachi.setEnabled(true);
            QLKH_tenkh.setEnabled(true);
            QLKH_sdt.setEnabled(true);
            suathongtin = 1;
        }catch(Exception e){
            JOptionPane.showMessageDialog(this, "Xin hãy chọn Khách hàng cần chỉnh sửa thông tin!");
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_QLKH_suathongtinActionPerformed

    private void table_hanghoaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_hanghoaMouseClicked
        int n = table_hanghoa.getSelectedRow();
        TTHH_mahang.setText((String) table_hanghoa.getValueAt(n, 0));
        TTHH_tenhang.setText((String) table_hanghoa.getValueAt(n, 1));
        TTHH_loaihang.setSelectedItem((String) table_hanghoa.getValueAt(n, 2));
        TTHH_giaban.setText((String) table_hanghoa.getValueAt(n, 3)); 
        TTHH_loaihang.setEnabled(true);
        TTHH_tenhang.setEnabled(true);
        TTHH_giaban.setEnabled(true);
        TTHH_mahang.setEnabled(true);
        if(suathongtinHH == 1) TTHH_mahang.setEnabled(false);
        
        // TODO add your handling code here:        // TODO add your handling code here:
    }//GEN-LAST:event_table_hanghoaMouseClicked

    private void table_thongtinMaKHMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_thongtinMaKHMouseClicked
        chon_makhachhang.setSelectedIndex(table_thongtinMaKH.getSelectedRow());
        // TODO add your handling code here:
    }//GEN-LAST:event_table_thongtinMaKHMouseClicked

    private void chon_mahanghoaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chon_mahanghoaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_chon_mahanghoaActionPerformed

    private void table_thongtinhanghoaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_thongtinhanghoaMouseClicked
        chon_mahanghoa.setSelectedIndex(table_thongtinhanghoa.getSelectedRow());
        int n = table_thongtinhanghoa.getSelectedRow();
        CTDH_giaban.setText((String)table_thongtinhanghoa.getValueAt(n, 2));
        // TODO add your handling code here:
    }//GEN-LAST:event_table_thongtinhanghoaMouseClicked

    private void Xoa_dong_CTDHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Xoa_dong_CTDHActionPerformed
        int row = CTDH_table.getSelectedRow();
        DefaultTableModel table1;
        table1 = (DefaultTableModel) CTDH_table.getModel();
        table1.removeRow(row);

        // TODO add your handling code here:
    }//GEN-LAST:event_Xoa_dong_CTDHActionPerformed

    private void Lammoi_CTDHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Lammoi_CTDHActionPerformed
        DefaultTableModel table1;
        table1 = (DefaultTableModel) CTDH_table.getModel();
        table1.setRowCount(0);
        table_thongtinhanghoa.clearSelection();
        table_thongtinMaKH.clearSelection();
        CTDH_giaban.setText("");
        CTDH_soluong.setText("");
        // TODO add your handling code here:
    }//GEN-LAST:event_Lammoi_CTDHActionPerformed

    private void Them_CTDHActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Them_CTDHActionPerformed
        DefaultTableModel table1;
        table1 = (DefaultTableModel) CTDH_table.getModel();

        String mahang = (String) chon_mahanghoa.getSelectedItem();
        String soluong = CTDH_soluong.getText();
        String giaban = CTDH_giaban.getText();
        String tenhang = null;
        Connection conn = null;
        try {
            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            conn = (Connection) DriverManager.getConnection(connStr);
            int i, check = 0, checknull = 0;
            String soluongKT, soluongton;

            soluongKT = (String) CTDH_soluong.getText();
            mahang = (String) chon_mahanghoa.getSelectedItem();
            if (CTDH_soluong.getText().equals("") || CTDH_giaban.getText().equals("")) {
                checknull = 1;
                JOptionPane.showMessageDialog(this, "Chưa nhập số lượng hoặc đơn giá");
            } else {
                checknull = 0;
                
            }
            //2. thuc hien cau lenh SQL
            if (check == 0) {
                String sql1 = "select soluongton from khohang where mahang like '" + mahang + "'";
                Statement stmt1 = conn.createStatement();
                ResultSet rs1 = stmt1.executeQuery(sql1);
                while (rs1.next()) {
                    soluongton = rs1.getString(1);
                    int slt = Integer.parseInt(soluongton);
                    int slkt = Integer.parseInt(soluongKT);
                    if (slkt > slt) {
                        check = 0;
                        JOptionPane.showMessageDialog(this, "Số lượng tồn kho không đủ!");
                        //                                JOptionPane.showMessageDialog(this, "check0 = "+check);
                        break;
                    } else {
                        check = 1;
                        //                                JOptionPane.showMessageDialog(this, "check1 = "+check);
                    }
                }
            }

            if (check == 1 && checknull == 0) {
                String sql = "select tenhang from hanghoa where mahang like '" + mahang + "'";
                Statement stmt = conn.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                while (rs.next()) {
                    tenhang = (rs.getString(1));
                }
                //int stt = table1.getRowCount();
                chitietdonhang ctdh = new chitietdonhang();
                ArrayList<chitietdonhang> list = new ArrayList();
                ctdh.setCTDH_giaban(giaban);
                ctdh.setCTDH_mahang(mahang);
                ctdh.setCTDH_tenhang(tenhang);
                ctdh.setCTDH_soluong(soluong);
                list.add(ctdh);
                for (Object hanghoa : list) {
                    Object[] obj = {
                        ((chitietdonhang) ctdh).getCTDH_mahang(), ((chitietdonhang) ctdh).getCTDH_tenhang(), ((chitietdonhang) ctdh).getCTDH_soluong(), ((chitietdonhang) ctdh).getCTDH_giaban()
                    };
                    table1.addRow(obj);
                }
                table_thongtinhanghoa.clearSelection();
                CTDH_giaban.setText("");
                CTDH_soluong.setText("");
            } else {
            }

        } catch (Exception e) {
            System.out.println("Khong the noi ket");
            System.out.println(e.getMessage());
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_Them_CTDHActionPerformed

    private void Tao_DH_moiActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Tao_DH_moiActionPerformed
        try {

            //1. tao noi ket
            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            Connection conn = null;
            conn = (Connection) DriverManager.getConnection(connStr);
            int i, check = 0;
            String soluongKT, soluongton;
            String mahang = null, maKH, maHD, soluong, giaban;

            int checknull = 0;
            if (text_tennguoilapHD.getText().equals("")) {
                checknull = 1;
                JOptionPane.showMessageDialog(this, "Chưa nhập Tên người lập đơn hàng!");
            } else {
                checknull = 0;
                //JOptionPane.showMessageDialog(this, "Mot vai thong tin dang trong222222222"+soluong);
            }
            if (checknull == 0) {
                maKH = (String) chon_makhachhang.getSelectedItem();
                String nguoilapHD;
                nguoilapHD = text_tennguoilapHD.getText();
                String sql2 = "call themhoadonmoi(\"" + maKH + "\",\"" + nguoilapHD + "\")";
                Statement stmt2 = conn.createStatement();
                //                   String sql = "call themsachmoi(\"" + a +"\",\"" + b + "\",\"" + c +"\",\"" + d + "\",1)";
                stmt2.executeQuery(sql2);

                String sql3 = "SELECT concat(\"HD\",count(mahd)) FROM hoadon ;";
                Statement stmt3 = conn.createStatement();
                ResultSet rs2 = stmt3.executeQuery(sql3);
                rs2.next();
                maHD = (rs2.getString(1));

                for (i = 0; i < CTDH_table.getRowCount(); i++) {
                    soluong = (String) CTDH_table.getValueAt(i, 2);
                    mahang = (String) CTDH_table.getValueAt(i, 0);
                    giaban = (String) CTDH_table.getValueAt(i, 3);
                    String sql4 = "call themchitiethoadon(\"" + maHD + "\",\"" + mahang + "\",\"" + soluong + "\",\"" + giaban + "\")";
                    Statement stmt4 = conn.createStatement();
                    stmt4.executeQuery(sql4);

                }
                JOptionPane.showMessageDialog(this, "Thêm hóa đơn (" + maHD + ") thành công!");
                table_thongtinMaKH.clearSelection();
                DefaultTableModel table1;
                table1 = (DefaultTableModel) CTDH_table.getModel();
                table1.setRowCount(0);
                CTDH_giaban.setText("");
                CTDH_soluong.setText("");
            } else {
                //JOptionPane.showMessageDialog(this, "Khong du so luong ton cua san pham "+mahang+" !");
            }
            lammoi();

        } catch (Exception e) {
            System.out.println("Khong the noi ket");
            System.out.println(e.getMessage());
            JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_Tao_DH_moiActionPerformed

    private void CTDH_giabanActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_CTDH_giabanActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_CTDH_giabanActionPerformed

    private void table_thongtinkhachhangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_thongtinkhachhangMouseClicked
        int n = table_thongtinkhachhang.getSelectedRow();
        QLKH_makh.setText((String) table_thongtinkhachhang.getValueAt(n, 0));
        QLKH_tenkh.setText((String) table_thongtinkhachhang.getValueAt(n, 1));
        QLKH_diachi.setText((String) table_thongtinkhachhang.getValueAt(n, 2));
        QLKH_sdt.setText((String) table_thongtinkhachhang.getValueAt(n, 3));
        if(suathongtin == 0 )QLKH_makh.setEnabled(true);
        QLKH_diachi.setEnabled(true);
        QLKH_tenkh.setEnabled(true);
        QLKH_sdt.setEnabled(true);
        QLKH_suathongtin.setEnabled(true);        // TODO add your handling code here:
    }//GEN-LAST:event_table_thongtinkhachhangMouseClicked

    private void chon_makhachhangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_chon_makhachhangActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_chon_makhachhangActionPerformed

    private void nhap_matkhauKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_nhap_matkhauKeyPressed
        if (evt.getKeyCode()==KeyEvent.VK_ENTER){
            if (thaydoimatkhau == 0) {
                try {

                    Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
                    String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
                    Connection conn = DriverManager.getConnection(connStr);
                    String matkhau = null;
                    String sql1 = "select matkhau from matkhau";
                    Statement stmt1 = conn.createStatement();
                    ResultSet rs1 = stmt1.executeQuery(sql1);
                    while (rs1.next()) {
                        matkhau = rs1.getString(1);
                    }
                    
                    if (nhap_matkhau.getText().equals(matkhau)) {
                        quanlydonhang.setEnabled(true);
                        unblock_changePWD.setEnabled(false);

                        nhap_matkhau.setEnabled(false);
                        changePWD.setEnabled(true);
                        nhap_matkhau.setText("");
                        jlogin.setVisible(false);
                        jGTChucNang.setVisible(true);
                    } else {
                        JOptionPane.showMessageDialog(this, "Sai mật khẩu");
                    }
                } catch (Exception e) {
                    System.out.println("Khong the noi ket");
                    System.out.println(e.getMessage());
                    JOptionPane.showMessageDialog(this, "Thao tác thất bại!");
                }
        }
    }        // TODO add your handling code here:
    }//GEN-LAST:event_nhap_matkhauKeyPressed

    private void nhapkho_chonmahangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_nhapkho_chonmahangMouseClicked
        click=1;
    }//GEN-LAST:event_nhapkho_chonmahangMouseClicked

    private void nhapkho_chonmahangActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nhapkho_chonmahangActionPerformed
        if(click==1){
         int row=0;
         int n = table_thongkekhohang.getRowCount();
         String mahang=(String)nhapkho_chonmahang.getSelectedItem();
         for(row=0;row < n;row++){
             if(mahang.equals((String)table_thongkekhohang.getValueAt(row,0))){
                 table_thongkekhohang.setRowSelectionInterval(row, row);
                 nhapkho_tenhang.setText((String)table_thongkekhohang.getValueAt(row,1));
             }
         }
        }
    }//GEN-LAST:event_nhapkho_chonmahangActionPerformed

    private void table_thongtindonhangMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_table_thongtindonhangMouseClicked
         int n = table_thongtindonhang.getSelectedRow();   
         String tenhang = (String)table_thongtindonhang.getValueAt(n,1);
         table_thongtindonhang.setToolTipText(tenhang);
         
         // TODO add your handling code here:
    }//GEN-LAST:event_table_thongtindonhangMouseClicked
    
    public void lammoi() {
        DefaultTableModel table1, table2, table3, table4, table5, table6, table7, table8, table9, table10;
        DefaultComboBoxModel combobox1, combobox2, combobox3, combobox4;
        combobox1 = (DefaultComboBoxModel) chon_mahanghoa.getModel();
        combobox2 = (DefaultComboBoxModel) chon_makhachhang.getModel();
        combobox3 = (DefaultComboBoxModel) nhapkho_chonmahang.getModel();
        
        table2 = (DefaultTableModel) table_thongtinMaKH.getModel();
        table3 = (DefaultTableModel) table_thongkekhohang.getModel();
        table4 = (DefaultTableModel) table_nhatkynhapkho.getModel();
        table8 = (DefaultTableModel) table_hanghoa.getModel();
        //List<hanghoa> tablehanghoa = new ArrayList<>();
        Connection conn = null;

        ArrayList<hanghoa> list1 = new ArrayList();
        ArrayList<khachhang> list2 = new ArrayList();
        ArrayList<thongkekhohang> list3 = new ArrayList();
        ArrayList<nhatkynhapkho> list4 = new ArrayList();
        click=0;
        try {
            //1. tao noi ket

            Class.forName("com.mysql.cj.jdbc.Driver").newInstance();
            String connStr = "jdbc:mysql://127.0.0.1/dlphanbon?user=root";
            conn = (Connection) DriverManager.getConnection(connStr);
            //System.out.println("Noi ket thanh cong");             
            //2. thuc hien cau lenh SQL 
            try {
                String sql = "select hanghoa.mahang, tenhang, soluongton, loaihang, dongia  from hanghoa, khohang, banggia where hanghoa.mahang = khohang.mahang and hanghoa.mahang=banggia.mahang";
                Statement stmt = conn.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                combobox1.removeAllElements();
                combobox3.removeAllElements();
                
                table1 = (DefaultTableModel) table_thongtinhanghoa.getModel();
                while (rs.next()) {
                    combobox1.addElement(rs.getString(1));
                    combobox3.addElement(rs.getString(1));
                    
                    //System.out.println("Truy van "+ rs.getString(1));
                    hanghoa hh = new hanghoa();
                    hh.setMahanghoa(rs.getString(1));
                    hh.setTenhanghoa(rs.getString(2));
                    hh.setSlt(rs.getString(3));
                    hh.setLoaihang(rs.getString(4));
                    hh.setDongia(rs.getString(5));
                    thongkekhohang tkkh = new thongkekhohang();
                    tkkh.setMahang(rs.getString(1));
                    tkkh.setTenhang(rs.getString(2));
                    tkkh.setSlt(rs.getString(3));
                    list1.add(hh);
                    list3.add(tkkh);

                }
                table1.setRowCount(0);
                table3.setRowCount(0);
                table8.setRowCount(0);
                for (Object thongkekhohang : list3) {
                    Object[] obj3 = {
                        ((thongkekhohang) thongkekhohang).getMahang(), ((thongkekhohang) thongkekhohang).getTenhang(), ((thongkekhohang) thongkekhohang).getSlt()
                    };
                    table3.addRow(obj3);
                }
                for (Object hanghoa : list1) {
                    Object[] obj1 = {
                        ((hanghoa) hanghoa).getMahanghoa(),
                        ((hanghoa) hanghoa).getTenhanghoa(),
                        ((hanghoa) hanghoa).getDongia(),
                        ((hanghoa) hanghoa).getSlt()
                    };
                    table1.addRow(obj1);
                }
                for (Object hanghoa : list1) {
                    Object[] obj8 = {
                        ((hanghoa) hanghoa).getMahanghoa(),
                        ((hanghoa) hanghoa).getTenhanghoa(),
                        ((hanghoa) hanghoa).getLoaihang(),
                        ((hanghoa) hanghoa).getDongia()
                    };
                    table8.addRow(obj8);
                }

//                for (Object hanghoa: list1){
//                    Object[] obj1 = {
//                        ((hanghoa) hanghoa).getMahanghoa(), ((hanghoa) hanghoa).getTenhanghoa()
//                    };
//                    table1.addRow(obj1);                   
//                }
                String sql2 = "select maKH, hoten, diachi, sdt from khachhang";
                Statement stmt2 = conn.createStatement();
                ResultSet rs2 = stmt2.executeQuery(sql2);
                combobox2.removeAllElements();

                while (rs2.next()) {
                    combobox2.addElement(rs2.getString(1));
                    //System.out.println("Truy van "+ rs.getString(1));
                    khachhang kh = new khachhang();
                    kh.setMakh(rs2.getString(1));
                    kh.setTenkh(rs2.getString(2));
                    kh.setDiachi(rs2.getString(3));
                    kh.setSdt(rs2.getString(4));
                    list2.add(kh);

                }
                table2.setRowCount(0);
                for (Object khachhang : list2) {
                    Object[] obj2 = {
                        ((khachhang) khachhang).getMakh(), ((khachhang) khachhang).getTenkh(), ((khachhang) khachhang).getSdt()
                    };
                    table2.addRow(obj2);
                }

                String sql3 = "SELECT  stt_nhap, mahang, soluongnhapkho, ngaynhap from nhapkho ORDER BY stt_nhap DESC limit 20";
                Statement stmt3 = conn.createStatement();
                ResultSet rs3 = stmt3.executeQuery(sql3);
                while (rs3.next()) {
                    nhatkynhapkho nknk = new nhatkynhapkho();
                    nknk.setStt(rs3.getString(1));
                    nknk.setMahang(rs3.getString(2));
                    nknk.setSoluongnhapkho(rs3.getString(3));
                    nknk.setNgaynhap(rs3.getString(4));
                    list4.add(nknk);

                }
                table4.setRowCount(0);
                for (Object nhatkynhapkho : list4) {
                    Object[] obj4 = {
                        ((nhatkynhapkho) nhatkynhapkho).getStt(), ((nhatkynhapkho) nhatkynhapkho).getMahang(), ((nhatkynhapkho) nhatkynhapkho).getSoluongnhapkho(), ((nhatkynhapkho) nhatkynhapkho).getNgaynhap()
                    };
                    table4.addRow(obj4);
                }


                table6 = (DefaultTableModel) table_thongtinkhachhang.getModel();
                table6.setRowCount(0);
                for (Object khachhang : list2) {
                    Object[] obj6 = {
                        ((khachhang) khachhang).getMakh(), ((khachhang) khachhang).getTenkh(), ((khachhang) khachhang).getDiachi(), ((khachhang) khachhang).getSdt()
                    };
                    table6.addRow(obj6);

                }

                table7 = (DefaultTableModel) table_danhsachdonhang.getModel();
                table_danhsachdonhang.setToolTipText(null);
                thongtindonhang_month.setSelectedIndex(0);
                thongtindonhang_year.setText("");
                ArrayList<danhsachdonhang> list6 = new ArrayList();
                String sql5 = "select a.mahd, b.hoten, a.ngaylap, a.nguoilaphd, sum(c.soluong*c.dongia) as tongtien\n"
                        + "from hoadon a, khachhang b, chitiethoadon c\n"
                        + "where a.makh=b.makh and a.mahd=c.mahd\n"
                        + "group by a.mahd\n"
                        + "ORDER by CONVERT(SUBSTRING_INDEX(a.mahd,\"HD\",-1),UNSIGNED INTEGER) DESC";
                Statement stmt5 = conn.createStatement();
                ResultSet rs5 = stmt5.executeQuery(sql5);
                while (rs5.next()) {
                    danhsachdonhang dsdh = new danhsachdonhang();
                    dsdh.setMaDH(rs5.getString(1));
                    dsdh.setKhachhang(rs5.getString(2));
                    dsdh.setNgaylap(rs5.getString(3));
                    dsdh.setNguoilap(rs5.getString(4));
                    dsdh.setTongtien(rs5.getString(5));
                    list6.add(dsdh);

                }
                table7.setRowCount(0);
                for (Object danhsachdonhang : list6) {
                    Object[] obj6 = {
                        ((danhsachdonhang) danhsachdonhang).getMaDH(),
                        ((danhsachdonhang) danhsachdonhang).getKhachhang(),
                        ((danhsachdonhang) danhsachdonhang).getNgaylap(),
                        ((danhsachdonhang) danhsachdonhang).getNguoilap(),
                        ((danhsachdonhang) danhsachdonhang).getTongtien()
                    };
                    table7.addRow(obj6);
                }
                int doanhthu = 0;
                String tongtien;
                this.SL_donhang.setText("" + table_danhsachdonhang.getRowCount());
                this.danhsachdonhang_thoigian.setText("Tất cả / Năm");
                for (int i = 0; i < table_danhsachdonhang.getRowCount(); i++) {
                    tongtien = (String) table_danhsachdonhang.getValueAt(i, 4);
                    doanhthu += Integer.parseInt(tongtien);

                }
                this.doanhthu.setText("" + doanhthu);
                this.tongtien.setText("");
                this.thongtindonhang_madh.setText("");
                table9 = (DefaultTableModel)table_thongtindonhang.getModel();
                table_thongtindonhang.setToolTipText(null);
                table9.setRowCount(0);
                
            } catch (SQLException e) {
                System.out.println("Truy van khong thanh cong");
                System.out.println("Error: " + e.getMessage());
            }

        } catch (Exception e) {
            System.out.println("Khong the noi ket");
            System.out.println(e.getMessage());
            JOptionPane.showMessageDialog(this, "Không thể kết nối đến cơ sở dữ liệu");
        }
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(mainframe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(mainframe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(mainframe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(mainframe.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new mainframe().setVisible(true);
             
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField CTDH_giaban;
    private javax.swing.JTextField CTDH_soluong;
    private javax.swing.JTable CTDH_table;
    private javax.swing.JButton Lammoi_CTDH;
    private javax.swing.JTextArea QLKH_diachi;
    private javax.swing.JButton QLKH_huy;
    private javax.swing.JButton QLKH_huyluachon;
    private javax.swing.JButton QLKH_luu;
    private javax.swing.JTextField QLKH_makh;
    private javax.swing.JTextField QLKH_sdt;
    private javax.swing.JButton QLKH_suathongtin;
    private javax.swing.JTextField QLKH_tenkh;
    private javax.swing.JButton QLKH_themKHmoi;
    private javax.swing.JLabel SL_donhang;
    private javax.swing.JTextField TTHH_giaban;
    private javax.swing.JButton TTHH_huy;
    private javax.swing.JButton TTHH_huyluachon;
    private javax.swing.JComboBox<String> TTHH_loaihang;
    private javax.swing.JButton TTHH_luu;
    private javax.swing.JTextField TTHH_mahang;
    private javax.swing.JButton TTHH_suathongtin;
    private javax.swing.JTextArea TTHH_tenhang;
    private javax.swing.JButton TTHH_themHHmoi;
    private javax.swing.JButton Tao_DH_moi;
    private javax.swing.JButton Them_CTDH;
    private javax.swing.JButton Xemtatcadonhang;
    private javax.swing.JButton Xemtheothangvanam;
    private javax.swing.JButton Xoa_dong_CTDH;
    private javax.swing.JButton button_nhapkho;
    private javax.swing.JButton changePWD;
    private javax.swing.JComboBox<String> chon_mahanghoa;
    private javax.swing.JComboBox<String> chon_makhachhang;
    private javax.swing.JLabel danhsachdonhang_thoigian;
    private javax.swing.JLabel doanhthu;
    private javax.swing.JDialog jDialog1;
    private javax.swing.JFrame jFrame1;
    private javax.swing.JFrame jFrame2;
    private javax.swing.JFrame jFrame3;
    private javax.swing.JFrame jFrame4;
    private javax.swing.JFrame jFrame5;
    private javax.swing.JFrame jFrame6;
    private javax.swing.JFrame jFrame7;
    private javax.swing.JPanel jGTChucNang;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel38;
    private javax.swing.JLabel jLabel39;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel40;
    private javax.swing.JLabel jLabel41;
    private javax.swing.JLabel jLabel42;
    private javax.swing.JLabel jLabel43;
    private javax.swing.JLabel jLabel44;
    private javax.swing.JLabel jLabel45;
    private javax.swing.JLabel jLabel46;
    private javax.swing.JLabel jLabel47;
    private javax.swing.JLabel jLabel48;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel50;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLabel jLabel_MaKH;
    private javax.swing.JLabel jLabel_MaKH1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel_quanlykhohang;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane10;
    private javax.swing.JScrollPane jScrollPane11;
    private javax.swing.JScrollPane jScrollPane12;
    private javax.swing.JScrollPane jScrollPane13;
    private javax.swing.JScrollPane jScrollPane14;
    private javax.swing.JScrollPane jScrollPane16;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JPanel jlogin;
    private javax.swing.JLabel label_matkhau;
    private javax.swing.JPasswordField nhap_matkhau;
    private javax.swing.JComboBox<String> nhapkho_chonmahang;
    private javax.swing.JTextField nhapkho_soluongnhapkho;
    private javax.swing.JTextArea nhapkho_tenhang;
    private javax.swing.JTabbedPane quanlydonhang;
    private javax.swing.JTable table_danhsachdonhang;
    private javax.swing.JTable table_hanghoa;
    private javax.swing.JTable table_nhatkynhapkho;
    private javax.swing.JTable table_thongkekhohang;
    private javax.swing.JTable table_thongtinMaKH;
    private javax.swing.JTable table_thongtindonhang;
    private javax.swing.JTable table_thongtinhanghoa;
    private javax.swing.JTable table_thongtinkhachhang;
    private javax.swing.JTextField text_tennguoilapHD;
    private javax.swing.JLabel thongtindonhang_madh;
    private javax.swing.JComboBox<String> thongtindonhang_month;
    private javax.swing.JTextField thongtindonhang_year;
    private javax.swing.JLabel tongtien;
    private javax.swing.JButton unblock_changePWD;
    // End of variables declaration//GEN-END:variables

    private ResultSet executeQuery(String sql) {
        throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
    }
}
